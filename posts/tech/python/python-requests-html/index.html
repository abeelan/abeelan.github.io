<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ABEE</title><meta name=keywords content><meta name=description content="requests-html API 使用示例。 官方文档 Github 移动端混合应用，除 API 接口外，还包含大量的 web 页面需要校验，进行自动化测试。 在 GitHub 上找到一个解析 HTML 页面的库，与 requests 库是同作者，大神出品，必属精品。哈哈，研究一下。 安装 仅支持 Python 3.6 及以上版本。 $ pip install requests-html 使用 请求数据的方法： 发送 web 请求，获取 HTML 响应 发送异步请求，异步获取 HTML 响"><meta name=author content="ABEE"><link rel=canonical href=https://abeelan.github.io/posts/tech/python/python-requests-html/><link crossorigin=anonymous href=/assets/css/stylesheet.fbe782675a7c7c9c739a48204d6d2a4da78a00e11ba93326b39891e3501b1740.css integrity="sha256-++eCZ1p8fJxzmkggTW0qTaeKAOEbqTMms5iR41AbF0A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://abeelan.github.io/img/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://abeelan.github.io/img/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://abeelan.github.io/img/favicon.ico><link rel=apple-touch-icon href=https://abeelan.github.io/img/favicon.ico><link rel=mask-icon href=https://abeelan.github.io/img/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script src=https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js></script><script>var _hmt=_hmt||[];(function(){var a=document.createElement("script"),b;a.src="",b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b)})()</script><meta property="og:title" content><meta property="og:description" content="requests-html API 使用示例。 官方文档 Github 移动端混合应用，除 API 接口外，还包含大量的 web 页面需要校验，进行自动化测试。 在 GitHub 上找到一个解析 HTML 页面的库，与 requests 库是同作者，大神出品，必属精品。哈哈，研究一下。 安装 仅支持 Python 3.6 及以上版本。 $ pip install requests-html 使用 请求数据的方法： 发送 web 请求，获取 HTML 响应 发送异步请求，异步获取 HTML 响"><meta property="og:type" content="article"><meta property="og:url" content="https://abeelan.github.io/posts/tech/python/python-requests-html/"><meta property="article:section" content="posts"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="requests-html API 使用示例。 官方文档 Github 移动端混合应用，除 API 接口外，还包含大量的 web 页面需要校验，进行自动化测试。 在 GitHub 上找到一个解析 HTML 页面的库，与 requests 库是同作者，大神出品，必属精品。哈哈，研究一下。 安装 仅支持 Python 3.6 及以上版本。 $ pip install requests-html 使用 请求数据的方法： 发送 web 请求，获取 HTML 响应 发送异步请求，异步获取 HTML 响"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"📚 分类","item":"https://abeelan.github.io/posts/"},{"@type":"ListItem","position":2,"name":"👨🏻‍💻 技术","item":"https://abeelan.github.io/posts/tech/"},{"@type":"ListItem","position":3,"name":"","item":"https://abeelan.github.io/posts/tech/python/python-requests-html/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"","name":"","description":"requests-html API 使用示例。 官方文档 Github 移动端混合应用，除 API 接口外，还包含大量的 web 页面需要校验，进行自动化测试。 在 GitHub 上找到一个解析 HTML 页面的库，与 requests 库是同作者，大神出品，必属精品。哈哈，研究一下。 安装 仅支持 Python 3.6 及以上版本。 $ pip install requests-html 使用 请求数据的方法： 发送 web 请求，获取 HTML 响应 发送异步请求，异步获取 HTML 响","keywords":[],"articleBody":" requests-html API 使用示例。\n官方文档\nGithub\n 移动端混合应用，除 API 接口外，还包含大量的 web 页面需要校验，进行自动化测试。\n在 GitHub 上找到一个解析 HTML 页面的库，与 requests 库是同作者，大神出品，必属精品。哈哈，研究一下。\n安装 仅支持 Python 3.6 及以上版本。\n$ pip install requests-html 使用 请求数据的方法：\n 发送 web 请求，获取 HTML 响应 发送异步请求，异步获取 HTML 响应 解析本地 HTML 文件  解析数据的方法：\n links/absolute_links：获取网页链接 find：基于 CSS 选择器提取 xpath：基于 xpath 语法提取 search/search_all：正则获取文本内容  JavaScript 渲染：\n render() arender()：异步渲染  1、请求数据 请求方法与 requests 一样，因为他们是继承的关系。\n# 发送请求 from requests_html import HTMLSession session = HTMLSession() r = session.get('https://python.org/') html = r.html # 异步请求 from requests_html import AsyncHTMLSession asession = AsyncHTMLSession() r = await asession.get('https://python.org/') html = r.html # 本地 HTML 文件 from requests_html import HTML doc = \"\"\"\"\"\" html = HTML(html=doc) 以上三种方式都会得到一个 HTML 对象，后面的数据操作都是基于这个 HTML 对象进行的。\n2、提取数据 简单了解下 API 的使用方法。\nLinks 获取页面上所有的链接（href 标签）。\nfrom requests_html import HTMLSession session = HTMLSession() r = session.get(\"https://www.baidu.com/\") html = r.html \"\"\" 相对链接：Home 绝对链接：Home \"\"\" # 获取全部链接，包含相对链接 html.links # 获取绝对链接，自动拼接前缀 html.absolute_links Text 获取页面上所有的文本内容。\nsession = HTMLSession() r = session.get(\"https://www.baidu.com/\") html = r.html # 元素内和 HTML 标签内的文本内容 html.text # 包含链接文本内容 html.full_text 获取整个页面的文本内容，数据量往往非常大，且不好清洗，所以一般都是对单个元素使用。当对某一个元素使用时，就获取该元素内的文本内容，后面会用到。\nXPATH 通过 XPATH 语法 获取数据。\n# 获取页面中的书名和作者 # == 后面跟的是输出 session = HTMLSession() r = session.get(\"https://book.easou.com/ta/index.m\") html = r.html # 获取第一条匹配的数据，上文中 text 的好处在这里就体现出来了 element = html.xpath(\"//div[@class='text']\", first=True) element.text # 获取所有匹配的数据，elements 是一个组 elements = html.xpath(\"//div[@class='text']\") # 找到一本下标为 5 的书籍，获取该元素内的全部文本信息 elements[5].text.split(\"\\n\") == ['遮天', '辰东', '古典仙侠', '冰冷与黑暗并存的宇宙深处，九具...', '630.6万字', '古典仙侠'] CSS 通过 CSS 选择器 获取数据。\n# 获取页面上的 tab 名称 session = HTMLSession() r = session.get(\"https://book.easou.com/ta/index.m\") html = r.html # 获取第一个 tab 的名称 element = html.find(\"div.banner li\", first=True) element.text == '精选' # 获取全部 tab 名，这是 css selector 的另一种写法 elements = html.find(\"div[class='banner'] li\") tabs = [ele.text for ele in elements] == ['精选', '分类', '免费', '书架'] # 获取包含关键字的 tab 名 elements = html.find(\"div[class='banner'] li\", containing=\"书\") elements[0].text == '书架' re 基于正则获取数据。\n# 获取排行榜第一页的书名 session = HTMLSession() r = session.get(\"https://book.easou.com/ta/rank.m?pageName=排行\") html = r.html \"\"\" 1. search() 返回第一条匹配的数据 \"\"\" # 使用大括号匹配文本，类似 (.*?) element1 = html.search('{}') element2 = html.search('{desc}') # 返回的是一个对象，包含一个元组，一个字典 # 大括号内为空，未对数据命名，数据放在元组内，通过下标取值 # 大括号内对数据命名，数据放在字典内，仅能通过 dict[key] 取值，不支持 get() element1 == Result ('深空彼岸',) {} element2 == Result () {'desc': '浩瀚的宇宙中，一片星系的生灭，也不过是...'} element1[0] == '深空彼岸' element2[\"desc\"] == '浩瀚的宇宙中，一片星系的生灭，也不过是...' \"\"\" 2. search_all() 返回全部数据 \"\"\" elements = html.search_all('{}') books = [ele[0] for ele in elements] len(books) == 20 3、JavaScript 渲染 简单说下 JavaScript 渲染。\n在浏览器访问一个链接，中间过程省略，浏览器会得到服务器返回的响应内容，开始生成 HTML DOM 树、渲染树，当遇到 JavaScript 脚本，也就是  标签时，会阻塞，等待 js 脚本执行，完成最终页面渲染。\n使用代码直接发送页面请求时，无法获取利用 JavaScript 生成的页面，必须借助浏览器内核实现。这里实现渲染能力借助的是 Chromium 无头浏览器，页面渲染时是无感的。\n 引用作者描述\nReloads the response in Chromium, and replaces HTML content with an updated version, with JavaScript executed.\n 通过百度主页的热搜模块，演示该功能。\n# 百度热搜 模块就是通过 js 渲染的 session = HTMLSession() r = session.get( url=\"https://www.baidu.com/\", headers={\"user-agent\": \"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Mobile Safari/537.36\"} ) html = r.html # 查看页面数据 html.html == 输出的文本内容里没有包含「百度热搜」关键词 # 进行页面渲染后，再次打印 html.render() html.html == 输出文本中包含「百度热搜」关键词 # 拿到热搜数据 hot_items = html.find(\"span[class='title-content-title']\") hot_news = [e.text for e in hot_items] hot_news == [ '讲好冬奥故事 共赴冰雪之约', '天津出现45起家庭聚集疫情', '春节返乡31省份防疫要求汇总来了', ... ] 仅第一次运行 render() 方法时，会下载 Chromium。可能会下载失败：\n 受网络影响（下载需要访问外网服务器，不稳定）; urllib3 版本号需要小于 1.25，我报错后通过下面命令回退版本后解决。  # pyppeteer.errors.NetworkError: Execution context was destroyed, most likely because of a navigation. $ pip install -U \"urllib3 4、异步请求 from requests_html import AsyncHTMLSession, HTML urls = [ \"https://www.baidu.com/\", \"https://python.org/\", \"https://www.bilibili.com/\" ] asession = AsyncHTMLSession() async def async_html(url) - HTML: r = await asession.get(url, headers=headers) html = r.html # 异步渲染页面 await html.arender() return html task = [lambda url=url: async_html(url) for url in urls] html_list: [HTML, ...] = asession.run(*task) == [ HTML url='https://www.python.org/', HTML url='https://www.baidu.com/', HTML url='https://www.bilibili.com/' ] 小技巧 1、选择器语法调试 通过 XPATH 或 CSS 选择器获取数据时，放在代码里面验证表达式的正确性，刚开始不熟悉，要多次修改表达式，效率很低。\n这种情况下可以使用 Chrome 开发者工具的搜索功能，快速验证表达式结果。\n使用方法：选中 Elementstab 项，调出搜索框（Ctrl + F），支持 XPATH 和 CSS 选择器搜索，写入表达式查看命中结果即可。\n2、如何查看当前页面是否是由 JavaScript 渲染而成的？ 设置 Chrome 开启/禁用 JavaScript，直达链接如下：\nchrome://settings/content/javascript 禁用后，访问页面，通过 JavaScript 渲染的页面或者模块是不会展示的。\n","wordCount":"2173","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":[{"@type":"Person","name":"ABEE"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://abeelan.github.io/posts/tech/python/python-requests-html/"},"publisher":{"@type":"Organization","name":"ABEE","logo":{"@type":"ImageObject","url":"https://abeelan.github.io/img/favicon.ico"}}}</script></head><body id=top><script>(function(){let a,b=new RegExp("(^| )change-themes=([^;]*)(;|$)");(a=document.cookie.match(b))||((new Date).getHours()>=19||(new Date).getHours()<6?(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark')):(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')))})(),localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><header class=header><nav class=nav><div class=logo><a href=https://abeelan.github.io/ accesskey=h title="ABEE (Alt + H)"><img src=https://abeelan.github.io/img/avatar.gif alt=logo aria-label=logo height=35>ABEE</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://abeelan.github.io/ title="🏠 主页"><span>🏠 主页</span></a></li><li><a href=https://abeelan.github.io/tags title="🧩 标签"><span>🧩 标签</span></a></li><li><a href=https://abeelan.github.io/archives/ title="⏱️ 时间轴"><span>⏱️ 时间轴</span></a></li><li><a href=https://abeelan.github.io/about title="🙋🏻‍♂️ 关于"><span>🙋🏻‍♂️ 关于</span></a></li><li><a href=https://abeelan.github.io/search title="🔍 搜索 (Alt + /)" accesskey=/><span>🔍 搜索</span></a></li></ul></nav></header><main class="main page"><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}body{counter-reset:h2}h2{counter-reset:h3}h3{counter-reset:h4}h4{counter-reset:h5}article[autonumbering] h2:before{counter-increment:h2;content:counter(h2)". "}article[autonumbering] h3:before{counter-increment:h3;content:counter(h2)"." counter(h3)" "}article[autonumbering] h4:before{counter-increment:h4;content:counter(h2)"." counter(h3)"." counter(h4)" "}article[autonumbering] .toc ul{counter-reset:item}article[autonumbering] .toc li a:before{content:counters(item,".")" ";counter-increment:item}</style><article class=post autonumbering><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://abeelan.github.io/>🏠 主页</a>&nbsp;»&nbsp;<a href=https://abeelan.github.io/posts/>📚 分类</a>&nbsp;»&nbsp;<a href=https://abeelan.github.io/posts/tech/>👨🏻‍💻 技术</a></div><h1 class=post-title></h1><div class=post-meta><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}.parent-post-meta{display:flex;flex-wrap:wrap;opacity:.8}</style><span class=parent-post-meta><span id=post_meta_style_1><span class="fa fa-calendar-check-o"></span><span>0001-01-01
&nbsp;&nbsp;</span></span>
<span id=post_meta_style_3><span class="fa fa-file-word-o"></span><span>2173字
&nbsp;&nbsp;</span></span>
<span id=post_meta_style_4><span class="fa fa-clock-o"></span><span>5分钟
&nbsp;&nbsp;</span></span>
<span id=post_meta_style_5><span class="fa fa-user-o"></span><span>ABEE
&nbsp;&nbsp;</span></span>
<span id=post_meta_style_6><span class="fa fa-tags" style=opacity:.8></span><span></span></span></span><span style=opacity:.8><span id=post_meta_style_7>&nbsp;&nbsp;
<span class="fa fa-eye"></span><span><span id=busuanzi_container_page_pv><span id=busuanzi_value_page_pv></span></span>&nbsp;&nbsp;</span></span>
<span id=post_meta_style_8><span class="fa fa-commenting-o"></span><span><script src=https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js></script><script>let url=document.documentURI,dnsUrl="https://abeelan.github.io/",urlSplit=url.split(dnsUrl),finalUrl=urlSplit[1];finalUrl[0]!=='/'&&(finalUrl='/'+finalUrl),twikoo.getCommentsCount({envId:null,region:"ap-beijing",urls:[finalUrl],includeReply:!1}).then(function(a){let b=a[0].count;const c=document.getElementById("comment_count");c.innerText=b}).catch(function(a){console.error(a)})</script><span id=comment_count></span></span></span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e5%ae%89%e8%a3%85 aria-label=安装>安装</a></li><li><a href=#%e4%bd%bf%e7%94%a8 aria-label=使用>使用</a></li><li><a href=#1%e8%af%b7%e6%b1%82%e6%95%b0%e6%8d%ae aria-label=1、请求数据>1、请求数据</a></li><li><a href=#2%e6%8f%90%e5%8f%96%e6%95%b0%e6%8d%ae aria-label=2、提取数据>2、提取数据</a><ul><ul><li><a href=#links aria-label=Links>Links</a></li><li><a href=#text aria-label=Text>Text</a></li><li><a href=#xpath aria-label=XPATH>XPATH</a></li><li><a href=#css aria-label=CSS>CSS</a></li><li><a href=#re aria-label=re>re</a></li></ul></ul></li><li><a href=#3javascript-%e6%b8%b2%e6%9f%93 aria-label="3、JavaScript 渲染">3、JavaScript 渲染</a></li><li><a href=#4%e5%bc%82%e6%ad%a5%e8%af%b7%e6%b1%82 aria-label=4、异步请求>4、异步请求</a></li><li><a href=#%e5%b0%8f%e6%8a%80%e5%b7%a7 aria-label=小技巧>小技巧</a><ul><ul><li><a href=#1%e9%80%89%e6%8b%a9%e5%99%a8%e8%af%ad%e6%b3%95%e8%b0%83%e8%af%95 aria-label=1、选择器语法调试>1、选择器语法调试</a></li><li><a href=#2%e5%a6%82%e4%bd%95%e6%9f%a5%e7%9c%8b%e5%bd%93%e5%89%8d%e9%a1%b5%e9%9d%a2%e6%98%af%e5%90%a6%e6%98%af%e7%94%b1-javascript-%e6%b8%b2%e6%9f%93%e8%80%8c%e6%88%90%e7%9a%84 aria-label="2、如何查看当前页面是否是由 JavaScript 渲染而成的？">2、如何查看当前页面是否是由 JavaScript 渲染而成的？</a></li></ul></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener('DOMContentLoaded',function(b){checkTocPosition(),elements=document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]'),activeElement=elements[0];const a=encodeURI(activeElement.getAttribute('id')).toLowerCase();document.querySelector(`.inner ul li a[href="#${a}"]`).classList.add('active')},!1),window.addEventListener('resize',function(a){checkTocPosition()},!1),window.addEventListener('scroll',()=>{activeElement=Array.from(elements).find(a=>{if(getOffsetTop(a)-window.pageYOffset>0&&getOffsetTop(a)-window.pageYOffset<window.innerHeight/2)return a})||activeElement,elements.forEach(a=>{const b=encodeURI(a.getAttribute('id')).toLowerCase();a===activeElement?document.querySelector(`.inner ul li a[href="#${b}"]`).classList.add('active'):document.querySelector(`.inner ul li a[href="#${b}"]`).classList.remove('active')})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue('--gap'),10);function checkTocPosition(){const a=document.body.scrollWidth;a-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(a){if(!a.getClientRects().length)return 0;let b=a.getBoundingClientRect(),c=a.ownerDocument.defaultView;return b.top+c.pageYOffset}</script><div class=post-content><blockquote><p>requests-html API 使用示例。</p><p><a href=https://docs.python-requests.org/projects/requests-html/en/latest/ title=Docs>官方文档</a></p><p><a href=https://github.com/psf/requests-html title=Github>Github</a></p></blockquote><p>移动端混合应用，除 API 接口外，还包含大量的 web 页面需要校验，进行自动化测试。</p><p>在 GitHub 上找到一个解析 HTML 页面的库，与 requests 库是同作者，大神出品，必属精品。哈哈，研究一下。</p><h3 id=安装>安装<a hidden class=anchor aria-hidden=true href=#安装>#</a></h3><p>仅支持 Python 3.6 及以上版本。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ pip install requests-html
</code></pre></div><h3 id=使用>使用<a hidden class=anchor aria-hidden=true href=#使用>#</a></h3><p>请求数据的方法：</p><ul><li>发送 web 请求，获取 HTML 响应</li><li>发送异步请求，异步获取 HTML 响应</li><li>解析本地 HTML 文件</li></ul><p>解析数据的方法：</p><ul><li>links/absolute_links：获取网页链接</li><li>find：基于 CSS 选择器提取</li><li>xpath：基于 xpath 语法提取</li><li>search/search_all：正则获取文本内容</li></ul><p>JavaScript 渲染：</p><ul><li>render()</li><li>arender()：异步渲染</li></ul><h3 id=1请求数据>1、请求数据<a hidden class=anchor aria-hidden=true href=#1请求数据>#</a></h3><p>请求方法与 requests 一样，因为他们是继承的关系。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># 发送请求</span>
<span style=color:#f92672>from</span> requests_html <span style=color:#f92672>import</span> HTMLSession

session <span style=color:#f92672>=</span> HTMLSession()
r <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;https://python.org/&#39;</span>)
html <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>html
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># 异步请求</span>
<span style=color:#f92672>from</span> requests_html <span style=color:#f92672>import</span> AsyncHTMLSession

asession <span style=color:#f92672>=</span> AsyncHTMLSession()
r <span style=color:#f92672>=</span> await asession<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;https://python.org/&#39;</span>)
html <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>html
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># 本地 HTML 文件</span>
<span style=color:#f92672>from</span> requests_html <span style=color:#f92672>import</span> HTML

doc <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;&lt;a href=&#39;https://httpbin.org&#39;&gt;&#34;&#34;&#34;</span>
html <span style=color:#f92672>=</span> HTML(html<span style=color:#f92672>=</span>doc)
</code></pre></div><p>以上三种方式都会得到一个 HTML 对象，后面的数据操作都是基于这个 HTML 对象进行的。</p><h3 id=2提取数据>2、提取数据<a hidden class=anchor aria-hidden=true href=#2提取数据>#</a></h3><p>简单了解下 API 的使用方法。</p><h5 id=links>Links<a hidden class=anchor aria-hidden=true href=#links>#</a></h5><p>获取页面上所有的链接（href 标签）。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> requests_html <span style=color:#f92672>import</span> HTMLSession

session <span style=color:#f92672>=</span> HTMLSession()
r <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;https://www.baidu.com/&#34;</span>)
html <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>html

<span style=color:#e6db74>&#34;&#34;&#34; 
</span><span style=color:#e6db74>相对链接：&lt;a href=&#34;/index.html&#34;&gt;Home&lt;/a&gt;
</span><span style=color:#e6db74>绝对链接：&lt;a href=&#34;https://www.navegabem.com/index.html&#34;&gt;Home&lt;/a&gt;
</span><span style=color:#e6db74>&#34;&#34;&#34;</span>

<span style=color:#75715e># 获取全部链接，包含相对链接</span>
html<span style=color:#f92672>.</span>links

<span style=color:#75715e># 获取绝对链接，自动拼接前缀</span>
html<span style=color:#f92672>.</span>absolute_links  
</code></pre></div><h5 id=text>Text<a hidden class=anchor aria-hidden=true href=#text>#</a></h5><p>获取页面上所有的文本内容。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>session <span style=color:#f92672>=</span> HTMLSession()
r <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;https://www.baidu.com/&#34;</span>)
html <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>html

<span style=color:#75715e># 元素内和 HTML 标签内的文本内容</span>
html<span style=color:#f92672>.</span>text

<span style=color:#75715e># 包含链接文本内容</span>
html<span style=color:#f92672>.</span>full_text
</code></pre></div><p>获取整个页面的文本内容，数据量往往非常大，且不好清洗，所以一般都是对单个元素使用。当对某一个元素使用时，就获取该元素内的文本内容，后面会用到。</p><h5 id=xpath>XPATH<a hidden class=anchor aria-hidden=true href=#xpath>#</a></h5><p>通过 <a href=https://www.w3schools.com/xml/xpath_syntax.asp title=xpath>XPATH 语法</a> 获取数据。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># 获取页面中的书名和作者</span>
<span style=color:#75715e># ==&gt; 后面跟的是输出</span>
session <span style=color:#f92672>=</span> HTMLSession()
r <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;https://book.easou.com/ta/index.m&#34;</span>)
html <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>html

<span style=color:#75715e># 获取第一条匹配的数据，上文中 text 的好处在这里就体现出来了</span>
element <span style=color:#f92672>=</span> html<span style=color:#f92672>.</span>xpath(<span style=color:#e6db74>&#34;//div[@class=&#39;text&#39;]&#34;</span>, first<span style=color:#f92672>=</span>True)
element<span style=color:#f92672>.</span>text

<span style=color:#75715e># 获取所有匹配的数据，elements 是一个组</span>
elements <span style=color:#f92672>=</span> html<span style=color:#f92672>.</span>xpath(<span style=color:#e6db74>&#34;//div[@class=&#39;text&#39;]&#34;</span>)
<span style=color:#75715e># 找到一本下标为 5 的书籍，获取该元素内的全部文本信息</span>
elements[<span style=color:#ae81ff>5</span>]<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
<span style=color:#f92672>==&gt;</span> [<span style=color:#e6db74>&#39;遮天&#39;</span>, <span style=color:#e6db74>&#39;辰东&#39;</span>, <span style=color:#e6db74>&#39;古典仙侠&#39;</span>, <span style=color:#e6db74>&#39;冰冷与黑暗并存的宇宙深处，九具...&#39;</span>, <span style=color:#e6db74>&#39;630.6万字&#39;</span>, <span style=color:#e6db74>&#39;古典仙侠&#39;</span>]
</code></pre></div><h5 id=css>CSS<a hidden class=anchor aria-hidden=true href=#css>#</a></h5><p>通过 <a href=https://www.w3schools.com/cssref/css_selectors.asp title=css>CSS 选择器</a> 获取数据。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># 获取页面上的 tab 名称</span>
session <span style=color:#f92672>=</span> HTMLSession()
r <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;https://book.easou.com/ta/index.m&#34;</span>)
html <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>html

<span style=color:#75715e># 获取第一个 tab 的名称</span>
element <span style=color:#f92672>=</span> html<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#34;div.banner li&#34;</span>, first<span style=color:#f92672>=</span>True)
element<span style=color:#f92672>.</span>text
<span style=color:#f92672>==&gt;</span> <span style=color:#e6db74>&#39;精选&#39;</span>

<span style=color:#75715e># 获取全部 tab 名，这是 css selector 的另一种写法</span>
elements <span style=color:#f92672>=</span> html<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#34;div[class=&#39;banner&#39;] li&#34;</span>)
tabs <span style=color:#f92672>=</span> [ele<span style=color:#f92672>.</span>text <span style=color:#66d9ef>for</span> ele <span style=color:#f92672>in</span> elements]
<span style=color:#f92672>==&gt;</span> [<span style=color:#e6db74>&#39;精选&#39;</span>, <span style=color:#e6db74>&#39;分类&#39;</span>, <span style=color:#e6db74>&#39;免费&#39;</span>, <span style=color:#e6db74>&#39;书架&#39;</span>]

<span style=color:#75715e># 获取包含关键字的 tab 名</span>
elements <span style=color:#f92672>=</span> html<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#34;div[class=&#39;banner&#39;] li&#34;</span>, containing<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;书&#34;</span>)
elements[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>text
<span style=color:#f92672>==&gt;</span> <span style=color:#e6db74>&#39;书架&#39;</span>
</code></pre></div><h5 id=re>re<a hidden class=anchor aria-hidden=true href=#re>#</a></h5><p>基于正则获取数据。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># 获取排行榜第一页的书名</span>
session <span style=color:#f92672>=</span> HTMLSession()
r <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;https://book.easou.com/ta/rank.m?pageName=排行&#34;</span>)
html <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>html

<span style=color:#e6db74>&#34;&#34;&#34;
</span><span style=color:#e6db74>1. search() 返回第一条匹配的数据
</span><span style=color:#e6db74>&#34;&#34;&#34;</span>
<span style=color:#75715e># 使用大括号匹配文本，类似 (.*?)</span>
element1 <span style=color:#f92672>=</span> html<span style=color:#f92672>.</span>search(<span style=color:#e6db74>&#39;&lt;div class=&#34;title&#34;&gt;{}&lt;/div&gt;&#39;</span>)
element2 <span style=color:#f92672>=</span> html<span style=color:#f92672>.</span>search(<span style=color:#e6db74>&#39;&lt;div class=&#34;desc&#34;&gt;{desc}&lt;/div&gt;&#39;</span>)

<span style=color:#75715e># 返回的是一个对象，包含一个元组，一个字典</span>
<span style=color:#75715e># 大括号内为空，未对数据命名，数据放在元组内，通过下标取值</span>
<span style=color:#75715e># 大括号内对数据命名，数据放在字典内，仅能通过 dict[key] 取值，不支持 get()</span>
element1
<span style=color:#f92672>==&gt;</span> <span style=color:#f92672>&lt;</span>Result (<span style=color:#e6db74>&#39;深空彼岸&#39;</span>,) {}<span style=color:#f92672>&gt;</span>
element2
<span style=color:#f92672>==&gt;</span> <span style=color:#f92672>&lt;</span>Result () {<span style=color:#e6db74>&#39;desc&#39;</span>: <span style=color:#e6db74>&#39;浩瀚的宇宙中，一片星系的生灭，也不过是...&#39;</span>}<span style=color:#f92672>&gt;</span>

element1[<span style=color:#ae81ff>0</span>]
<span style=color:#f92672>==&gt;</span> <span style=color:#e6db74>&#39;深空彼岸&#39;</span>
element2[<span style=color:#e6db74>&#34;desc&#34;</span>]
<span style=color:#f92672>==&gt;</span> <span style=color:#e6db74>&#39;浩瀚的宇宙中，一片星系的生灭，也不过是...&#39;</span>

<span style=color:#e6db74>&#34;&#34;&#34;
</span><span style=color:#e6db74>2. search_all() 返回全部数据
</span><span style=color:#e6db74>&#34;&#34;&#34;</span>
elements <span style=color:#f92672>=</span> html<span style=color:#f92672>.</span>search_all(<span style=color:#e6db74>&#39;&lt;div class=&#34;title&#34;&gt;{}&lt;/div&gt;&#39;</span>)
books <span style=color:#f92672>=</span> [ele[<span style=color:#ae81ff>0</span>] <span style=color:#66d9ef>for</span> ele <span style=color:#f92672>in</span> elements]
len(books)
<span style=color:#f92672>==&gt;</span> <span style=color:#ae81ff>20</span>
</code></pre></div><h3 id=3javascript-渲染>3、JavaScript 渲染<a hidden class=anchor aria-hidden=true href=#3javascript-渲染>#</a></h3><p>简单说下 JavaScript 渲染。</p><p>在浏览器访问一个链接，中间过程省略，浏览器会得到服务器返回的响应内容，开始生成 HTML DOM 树、渲染树，当遇到 JavaScript 脚本，也就是 <code>&lt;script></code> 标签时，会阻塞，等待 js 脚本执行，完成最终页面渲染。</p><p>使用代码直接发送页面请求时，无法获取利用 JavaScript 生成的页面，必须借助浏览器内核实现。这里实现渲染能力借助的是 Chromium 无头浏览器，页面渲染时是无感的。</p><blockquote><p>引用作者描述</p><p>Reloads the response in Chromium, and replaces HTML content with an updated version, with JavaScript executed.</p></blockquote><p>通过百度主页的热搜模块，演示该功能。</p><p><img loading=lazy src=https://gitee.com/abeelan/image-hosting-service/raw/master/img/image-20220114191324577.png alt></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># 百度热搜 模块就是通过 js 渲染的</span>
session <span style=color:#f92672>=</span> HTMLSession()
r <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(
    url<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://www.baidu.com/&#34;</span>,
    headers<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#34;user-agent&#34;</span>: <span style=color:#e6db74>&#34;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Mobile Safari/537.36&#34;</span>}
)
html <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>html

<span style=color:#75715e># 查看页面数据</span>
html<span style=color:#f92672>.</span>html
<span style=color:#f92672>==&gt;</span> <span style=color:#960050;background-color:#1e0010>输出的文本内容里没有包含「百度热搜」关键词</span>

<span style=color:#75715e># 进行页面渲染后，再次打印</span>
html<span style=color:#f92672>.</span>render()
html<span style=color:#f92672>.</span>html
<span style=color:#f92672>==&gt;</span> <span style=color:#960050;background-color:#1e0010>输出文本中包含「百度热搜」关键词</span>

<span style=color:#75715e># 拿到热搜数据</span>
hot_items <span style=color:#f92672>=</span> html<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#34;span[class=&#39;title-content-title&#39;]&#34;</span>)
hot_news <span style=color:#f92672>=</span> [e<span style=color:#f92672>.</span>text <span style=color:#66d9ef>for</span> e <span style=color:#f92672>in</span> hot_items]
hot_news
<span style=color:#f92672>==&gt;</span> [
 <span style=color:#e6db74>&#39;讲好冬奥故事 共赴冰雪之约&#39;</span>,
 <span style=color:#e6db74>&#39;天津出现45起家庭聚集疫情&#39;</span>,
 <span style=color:#e6db74>&#39;春节返乡31省份防疫要求汇总来了&#39;</span>,
  <span style=color:#f92672>...</span>
]
</code></pre></div><p>仅第一次运行 render() 方法时，会下载 Chromium。可能会下载失败：</p><ul><li>受网络影响（下载需要访问外网服务器，不稳定）;</li><li>urllib3 版本号需要小于 1.25，我报错后通过下面命令回退版本后解决。</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># pyppeteer.errors.NetworkError: Execution context was destroyed, most likely because of a navigation.</span>
$ pip install -U <span style=color:#e6db74>&#34;urllib3&lt;1.25&#34;</span>
</code></pre></div><h3 id=4异步请求>4、异步请求<a hidden class=anchor aria-hidden=true href=#4异步请求>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> requests_html <span style=color:#f92672>import</span> AsyncHTMLSession, HTML

urls <span style=color:#f92672>=</span> [
    <span style=color:#e6db74>&#34;https://www.baidu.com/&#34;</span>,
    <span style=color:#e6db74>&#34;https://python.org/&#34;</span>,
    <span style=color:#e6db74>&#34;https://www.bilibili.com/&#34;</span>
]

asession <span style=color:#f92672>=</span> AsyncHTMLSession()

async <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>async_html</span>(url) <span style=color:#f92672>-&gt;</span> HTML:
	r <span style=color:#f92672>=</span> await asession<span style=color:#f92672>.</span>get(url, headers<span style=color:#f92672>=</span>headers)
    html <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>html
    
    <span style=color:#75715e># 异步渲染页面</span>
    await html<span style=color:#f92672>.</span>arender()
	<span style=color:#66d9ef>return</span> html

task <span style=color:#f92672>=</span> [<span style=color:#66d9ef>lambda</span> url<span style=color:#f92672>=</span>url: async_html(url) <span style=color:#66d9ef>for</span> url <span style=color:#f92672>in</span> urls]
html_list: [HTML, <span style=color:#f92672>...</span>] <span style=color:#f92672>=</span> asession<span style=color:#f92672>.</span>run(<span style=color:#f92672>*</span>task)
<span style=color:#f92672>==&gt;</span> [
	<span style=color:#f92672>&lt;</span>HTML url<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;https://www.python.org/&#39;</span><span style=color:#f92672>&gt;</span>,
	<span style=color:#f92672>&lt;</span>HTML url<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;https://www.baidu.com/&#39;</span><span style=color:#f92672>&gt;</span>,
	<span style=color:#f92672>&lt;</span>HTML url<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;https://www.bilibili.com/&#39;</span><span style=color:#f92672>&gt;</span>
]
</code></pre></div><h3 id=小技巧>小技巧<a hidden class=anchor aria-hidden=true href=#小技巧>#</a></h3><h5 id=1选择器语法调试>1、选择器语法调试<a hidden class=anchor aria-hidden=true href=#1选择器语法调试>#</a></h5><p>通过 XPATH 或 CSS 选择器获取数据时，放在代码里面验证表达式的正确性，刚开始不熟悉，要多次修改表达式，效率很低。</p><p>这种情况下可以使用 Chrome 开发者工具的搜索功能，快速验证表达式结果。</p><p>使用方法：选中 <code>Elements</code>tab 项，调出搜索框（<code>Ctrl + F</code>），支持 XPATH 和 CSS 选择器搜索，写入表达式查看命中结果即可。</p><p><img loading=lazy src=https://gitee.com/abeelan/image-hosting-service/raw/master/img/image-20220114173442122.png alt=如图></p><h5 id=2如何查看当前页面是否是由-javascript-渲染而成的>2、如何查看当前页面是否是由 JavaScript 渲染而成的？<a hidden class=anchor aria-hidden=true href=#2如何查看当前页面是否是由-javascript-渲染而成的>#</a></h5><p>设置 Chrome 开启/禁用 JavaScript，直达链接如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>chrome://settings/content/javascript
</code></pre></div><p>禁用后，访问页面，通过 JavaScript 渲染的页面或者模块是不会展示的。</p></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://abeelan.github.io/img/wechatpay.jpg alt=wechat_pay></a><p>微信</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://abeelan.github.io/img/alipay.jpg alt=alipay></a><p>支付宝</p></div></div><button id=rewardButton onclick="var qr=document.getElementById('QR');qr.style.opacity==='0'?qr.style.opacity='1':qr.style.opacity='0'">
<span>🧧 鼓励一下 🧧</span></button></div></div><footer class=post-footer><nav class=paginav><a class=prev href=https://abeelan.github.io/posts/tech/python/python-jmespath%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/><span class=title>« 上一页</span><br><span></span></a><a class=next href=https://abeelan.github.io/posts/tech/python/python-requests-proxy/><span class=title>下一页 »</span><br><span></span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share  on twitter" href="https://twitter.com/intent/tweet/?text=&url=https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fpython%2fpython-requests-html%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fpython%2fpython-requests-html%2f&title=&summary=&source=https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fpython%2fpython-requests-html%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fpython%2fpython-requests-html%2f&title="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fpython%2fpython-requests-html%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on whatsapp" href="https://api.whatsapp.com/send?text=%20-%20https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fpython%2fpython-requests-html%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on telegram" href="https://telegram.me/share/url?text=&url=https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fpython%2fpython-requests-html%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></div></article></main><footer class=footer><span>Copyright
&copy;
-2023
<a href=https://abeelan.github.io/ style=color:#939393>ABEE</a>
All Rights Reserved</span>
<a href=https://beian.miit.gov.cn/ target=_blank style=color:#939393></a>&nbsp;
<span><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=null" style=display:inline-block;text-decoration:none;height:20px;color:#939393><img src style="float:left;margin:0 5px 0 0"></a></span>
<span id=busuanzi_container><span class="fa fa-user"></span><span id=busuanzi_value_site_uv></span><span class="fa fa-eye"></span><span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg><span id=read_progress></span></span></a><script>document.addEventListener('scroll',function(e){const a=document.getElementById("read_progress"),b=document.documentElement.scrollHeight,c=document.documentElement.clientHeight,d=document.documentElement.scrollTop||document.body.scrollTop;a.innerText=((d/(b-c)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>let mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>200||document.documentElement.scrollTop>200?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{(function(){document.cookie="change-themes="+escape("false")})(),document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.body.addEventListener('copy',function(a){if(window.getSelection().toString()&&window.getSelection().toString().length>50){let b=a.clipboardData||window.clipboardData;if(b){a.preventDefault();let c=window.getSelection().toString()+'\r\n\n————————————————\r\n'+'版权声明：本文为「'+"ABEE"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。'+'\r\n原文链接：'+location.href,d=window.getSelection().toString()+'\r\n\n————————————————\r\n'+'版权声明：本文为「'+"ABEE"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。'+'\r\n原文链接：'+location.href;b.setData('text/html',c),b.setData('text/plain',d)}}})</script><script>document.querySelectorAll('pre > code').forEach(c=>{const d=c.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='📄 复制';function i(){a.innerText='👌🏻 已复制!',setTimeout(()=>{a.innerText='📄 复制'},2e3)}a.addEventListener('click',d=>{if('clipboard'in navigator){let a=c.textContent+'\r\n————————————————\r\n'+'版权声明：本文为「'+"ABEE"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。'+'\r\n原文链接：'+location.href;navigator.clipboard.writeText(a),i();return}const a=document.createRange();a.selectNodeContents(c);const b=window.getSelection();b.removeAllRanges(),b.addRange(a);try{document.execCommand('copy'),i()}catch(a){}b.removeRange(a)});let j=c.className.replaceAll("language-",""),b=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),e=document.createElement("div");e.innerText=j,b.setAttribute('class','mac-tool'),f.setAttribute('class','mac bb1'),g.setAttribute('class','mac bb2'),h.setAttribute('class','mac bb3'),e.setAttribute('class','language-type'),b.appendChild(f),b.appendChild(g),b.appendChild(h),b.appendChild(e),d.classList.contains("highlight")?(d.appendChild(a),d.appendChild(b)):d.parentNode.firstChild==d||(c.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?(c.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a),d.appendChild(b)):(c.parentNode.appendChild(a),d.appendChild(b)))})</script><script>$("code[class^=language] ").on("mouseover",function(){this.clientWidth<this.scrollWidth&&($(this).css("width","135%"),$(this).css("border-top-right-radius","var(--radius)"))}).on("mouseout",function(){$(this).css("width","100%"),$(this).css("border-top-right-radius","unset")})</script></body></html>