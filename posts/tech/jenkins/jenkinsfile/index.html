<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ABEE</title><meta name=keywords content><meta name=description content="Jenkins Pipeline 一、概念 将整个持续集成的过程用解释性代码 jenkinsfile 来描述。 二、Jenkinsfile 使用方法 Pipeline script Pipeline script from SCM 1、Pipeline script 创建第一个 pipeline 项目 新建项目 输入项目名称 选择流水线项目 点击确定 进入配置页面，配置 pipeline 下拉到页面最底部，定义流水线脚本有两种方式，默认是在配置页面编辑脚本，也就是 Pipeline s"><meta name=author content="ABEE"><link rel=canonical href=https://abeelan.github.io/posts/tech/jenkins/jenkinsfile/><link crossorigin=anonymous href=/assets/css/stylesheet.fbe782675a7c7c9c739a48204d6d2a4da78a00e11ba93326b39891e3501b1740.css integrity="sha256-++eCZ1p8fJxzmkggTW0qTaeKAOEbqTMms5iR41AbF0A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://abeelan.github.io/img/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://abeelan.github.io/img/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://abeelan.github.io/img/favicon.ico><link rel=apple-touch-icon href=https://abeelan.github.io/img/favicon.ico><link rel=mask-icon href=https://abeelan.github.io/img/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script src=https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js></script><script>var _hmt=_hmt||[];(function(){var a=document.createElement("script"),b;a.src="",b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b)})()</script><meta property="og:title" content><meta property="og:description" content="Jenkins Pipeline 一、概念 将整个持续集成的过程用解释性代码 jenkinsfile 来描述。 二、Jenkinsfile 使用方法 Pipeline script Pipeline script from SCM 1、Pipeline script 创建第一个 pipeline 项目 新建项目 输入项目名称 选择流水线项目 点击确定 进入配置页面，配置 pipeline 下拉到页面最底部，定义流水线脚本有两种方式，默认是在配置页面编辑脚本，也就是 Pipeline s"><meta property="og:type" content="article"><meta property="og:url" content="https://abeelan.github.io/posts/tech/jenkins/jenkinsfile/"><meta property="article:section" content="posts"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="Jenkins Pipeline 一、概念 将整个持续集成的过程用解释性代码 jenkinsfile 来描述。 二、Jenkinsfile 使用方法 Pipeline script Pipeline script from SCM 1、Pipeline script 创建第一个 pipeline 项目 新建项目 输入项目名称 选择流水线项目 点击确定 进入配置页面，配置 pipeline 下拉到页面最底部，定义流水线脚本有两种方式，默认是在配置页面编辑脚本，也就是 Pipeline s"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"📚 分类","item":"https://abeelan.github.io/posts/"},{"@type":"ListItem","position":2,"name":"👨🏻‍💻 技术","item":"https://abeelan.github.io/posts/tech/"},{"@type":"ListItem","position":3,"name":"","item":"https://abeelan.github.io/posts/tech/jenkins/jenkinsfile/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"","name":"","description":"Jenkins Pipeline 一、概念 将整个持续集成的过程用解释性代码 jenkinsfile 来描述。 二、Jenkinsfile 使用方法 Pipeline script Pipeline script from SCM 1、Pipeline script 创建第一个 pipeline 项目 新建项目 输入项目名称 选择流水线项目 点击确定 进入配置页面，配置 pipeline 下拉到页面最底部，定义流水线脚本有两种方式，默认是在配置页面编辑脚本，也就是 Pipeline s","keywords":[],"articleBody":"Jenkins Pipeline 一、概念 将整个持续集成的过程用解释性代码 jenkinsfile 来描述。\n二、Jenkinsfile 使用方法  Pipeline script Pipeline script from SCM  1、Pipeline script 创建第一个 pipeline 项目\n 新建项目 输入项目名称 选择流水线项目 点击确定 进入配置页面，配置 pipeline  下拉到页面最底部，定义流水线脚本有两种方式，默认是在配置页面编辑脚本，也就是 Pipeline script，点击输入框右上角的\ntry simple Pipeline...\n就可以自动生成一个 demo 脚本。\npipeline { // 构建节点，any 代表任意节点 agent any // 构建阶段，可以有多个阶段 stages { // 构建阶段一 stage(\"Hello\") { // 阶段一执行的步骤一 // 可以有多个步骤 steps { // 步骤内构建脚本 echo \"Hello World!\" } } } // 构建后置操作 post { // always 代表总是触发 always { echo \"Say goodbye!\" } } } 保存配置后，进行构建，第一个流水线任务就建立完成了。\n2、Pipeline script from SCM 远程仓库检出脚本构建\n在配置页面上编写 jenkinsfile 有个缺点，如果内容有变更的话，需要登录 Jenkins 平台修改，比较麻烦。所以流水线项目提供从远程仓库检出 jenkiinsfile 的方式构建。\n 新建一个 Jenkins file，填入上面的脚本内容，提交远程代码仓库。 回到配置页面，流水线定义选中 Pipeline script form SCM，配置远程代码仓库 选择 SVN（Git 类似） 填写仓库地址（Repository URL） 配置验证信息，有代码仓库访问权限的账号（Credentials） 填写 Jenkinsfile 脚本路径，就是远程仓库脚本的存放目录 eg： ./ci/jenkinsfile 保存后进行构建  三、Jenkinsfile 语法  Declarative pipeline（结构化方式） Scripts pipeline（groovy 语法）  Declarative pipeline 1、所有内容必须包含在一个 pipeline 代码块内：pipeline {}\npipeline { ... } 2、agent（必填指令）：执行节点\n any：可以在任意节点上执行 pipeline 的构建 none：pipeline 不分配全局节点，每个 stage 自己分配 label：指定运行节点的 label node：自定义运行节点配置  指定 label 指定 自定义工作目录   docker：控制目标节点上的 docker 运行相关内容  pipeline { agent { node { label \"myslave\" customWorkspace \"myWorkSpace\" } } } 3、stages（必填指令）：包含一个或者多个 stage 的序列，pipeline 大部分工作在此执行。\n 无参数 唯一  4、stage（必填指令）：包含在 stages 中，pipeline 完成的所有工作都需要包含到 stage 中\n 无参数 需要定义 stage 名字 可以写多个  5、steps（必填指令）：包含在 stage 中，具体执行步骤\n 无参数 可以写多个  6、post（非必填指令）：定义 stages 运行结束后的操作\n always：无论 stages 运行结果如何，都会执行 changed：只有当运行结果与上次运行结果不同时，才会执行 failure：仅当运行结果为失败时，才会执行 sucess：仅当运行结果为成功时，才会执行 unstable：仅当运行结果不稳定时，才会执行 aborted：仅当运行中止状态时，才会执行  post { always { echo \"always\" } success { echo \"success\" sleep 2 } unstable { echo \"unstable\" } } 7、environment（非必填指令）：定义运行时环境变量，无参数\nenvironment { test = 'hello world' } stages { stage(\"print environment\") { steps { echo test } } } 8、options（非必填指令）：定义 pipeline 的专有属性，配置页内的其他自定义项\n buildDiscarder：保持构建的最大个数 disabelConcurrentBuilds：不允许并行执行 pipeline 任务 timeout：pipeline 超时时间 retry：重试次数 timestamps：预定义由 pipeline 生成的所有控制台输出时间 skipStagesAfterUnstable：一旦构建进入不稳定状态，就跳过此 stage  options { timeout(time: 30, unit: \"SECONDS\") buildDiscarder(logRotator(numToKeepStr: '2')) retry(5) } 9、parameters（非必填指令）：定义 pipeline 的专有参数列表\n 支持的数据类型  booleanParam choice credentials：证书 file text password run string   类似参数化构建的选项  parameters { string(name: \"PERSON\", defaultValue: \"jenkins\", description: \"输入的文本参数\") } stages { stage(\"Test Parameters\") { steps { echo \"Hello, ${params.PERSON}!\" } } } 10、triggers（非必填指令）：定义了 piplien 自动化触发的方式\n cron：接收一个 cron 风格的字符串来定义 pipeline 触发的常规间隔 pollSCM：接收一个 cron 风格的字符串来定义 Jenjkins 检查 SCM 源更改的常规间隔；如果存在更改，则 pipeline 被重新触发。  triggers { pollSCM('H */4 * * 1-5') } 11、parallel（非必填指令）：并行构建\npipeline { agent none stages { stage(\"并行构建\") { parallel { stage(\"stage - 001\") { agent { label \"slave1\" } steps { echo \"在 slave1 节点上执行 stage - 001.\" sh \"ifconfig\" sleep 10 } } stage(\"stage -002\") { agent { label \"slave2\" } steps { echo \"在 slave2 节点上执行 stage - 002.\" sh \"ifconfig\" sleep 10 } } } } } } 2、Scripts pipeline 基于 groovy 语法定制的一种领域专用语言（DSL）\n DSL (Domain Specific Language)\nA specialized computer language designed for a specific task.\n为了解决某一类任务而专门设计的计算机语言。\n 优点：\n 灵活性高 可扩展性更好 与 Declarative pipeline 语法类型  流程控制 - if/else\nnode { stage(\"if/else demo\"){ if (env.BRANCH_NAME == \"master\") { echo \"master branch\" } else { echo \"else branch\" } } } 流程控制 - try/carch\nnode { echo \"This is test stage which run on the slave agent.\" try { echo \"try block.\" } catch (exc) { echo \"catch block.\" } finally { // 兜底执行 \techo \"finally block.\" } } 控制全局工具设置的环境变量与运行命令\n 定义 maven Name \u0026 MAVEN_HOME 定义 java Name \u0026 JAVA_HOME 定义 allure Name \u0026 ALLURE_HOME …  stage(\"maven deploy\") { node(\"master\") { sh \". ~/.bash_profile\" // 定义 maven 工具，工具在全局工具设置添加好，这里去获取 \t// 全局工具设置（Manager Jenkins - Global Tools Configuration） \tdef mvnHome = tool \"maven_3.6.0_master\" def jdkHome = tool \"jdk_1.8_master\" env.PATH = \"${mvnHome}/bin:${env.PATH}\" env.PATH = \"${jdkHome}/bin:${env.PATH}\" sh \"mvn clean install\" sh \"mv target/iWeb.war target/ROOT.war\" } } 以上就是 jenkinsfile 的基本用法，先有一个大概的认识，了解了解语法，编写过程中随用随查。\n","wordCount":"2016","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":[{"@type":"Person","name":"ABEE"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://abeelan.github.io/posts/tech/jenkins/jenkinsfile/"},"publisher":{"@type":"Organization","name":"ABEE","logo":{"@type":"ImageObject","url":"https://abeelan.github.io/img/favicon.ico"}}}</script></head><body id=top><script>(function(){let a,b=new RegExp("(^| )change-themes=([^;]*)(;|$)");(a=document.cookie.match(b))||((new Date).getHours()>=19||(new Date).getHours()<6?(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark')):(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')))})(),localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><header class=header><nav class=nav><div class=logo><a href=https://abeelan.github.io/ accesskey=h title="ABEE (Alt + H)"><img src=https://abeelan.github.io/img/avatar.gif alt=logo aria-label=logo height=35>ABEE</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://abeelan.github.io/ title="🏠 主页"><span>🏠 主页</span></a></li><li><a href=https://abeelan.github.io/tags title="🧩 标签"><span>🧩 标签</span></a></li><li><a href=https://abeelan.github.io/archives/ title="⏱️ 时间轴"><span>⏱️ 时间轴</span></a></li><li><a href=https://abeelan.github.io/about title="🙋🏻‍♂️ 关于"><span>🙋🏻‍♂️ 关于</span></a></li><li><a href=https://abeelan.github.io/search title="🔍 搜索 (Alt + /)" accesskey=/><span>🔍 搜索</span></a></li></ul></nav></header><main class="main page"><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}body{counter-reset:h2}h2{counter-reset:h3}h3{counter-reset:h4}h4{counter-reset:h5}article[autonumbering] h2:before{counter-increment:h2;content:counter(h2)". "}article[autonumbering] h3:before{counter-increment:h3;content:counter(h2)"." counter(h3)" "}article[autonumbering] h4:before{counter-increment:h4;content:counter(h2)"." counter(h3)"." counter(h4)" "}article[autonumbering] .toc ul{counter-reset:item}article[autonumbering] .toc li a:before{content:counters(item,".")" ";counter-increment:item}</style><article class=post autonumbering><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://abeelan.github.io/>🏠 主页</a>&nbsp;»&nbsp;<a href=https://abeelan.github.io/posts/>📚 分类</a>&nbsp;»&nbsp;<a href=https://abeelan.github.io/posts/tech/>👨🏻‍💻 技术</a></div><h1 class=post-title></h1><div class=post-meta><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}.parent-post-meta{display:flex;flex-wrap:wrap;opacity:.8}</style><span class=parent-post-meta><span id=post_meta_style_1><span class="fa fa-calendar-check-o"></span><span>0001-01-01
&nbsp;&nbsp;</span></span>
<span id=post_meta_style_3><span class="fa fa-file-word-o"></span><span>2016字
&nbsp;&nbsp;</span></span>
<span id=post_meta_style_4><span class="fa fa-clock-o"></span><span>5分钟
&nbsp;&nbsp;</span></span>
<span id=post_meta_style_5><span class="fa fa-user-o"></span><span>ABEE
&nbsp;&nbsp;</span></span>
<span id=post_meta_style_6><span class="fa fa-tags" style=opacity:.8></span><span></span></span></span><span style=opacity:.8><span id=post_meta_style_7>&nbsp;&nbsp;
<span class="fa fa-eye"></span><span><span id=busuanzi_container_page_pv><span id=busuanzi_value_page_pv></span></span>&nbsp;&nbsp;</span></span>
<span id=post_meta_style_8><span class="fa fa-commenting-o"></span><span><script src=https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js></script><script>let url=document.documentURI,dnsUrl="https://abeelan.github.io/",urlSplit=url.split(dnsUrl),finalUrl=urlSplit[1];finalUrl[0]!=='/'&&(finalUrl='/'+finalUrl),twikoo.getCommentsCount({envId:null,region:"ap-beijing",urls:[finalUrl],includeReply:!1}).then(function(a){let b=a[0].count;const c=document.getElementById("comment_count");c.innerText=b}).catch(function(a){console.error(a)})</script><span id=comment_count></span></span></span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#jenkins-pipeline aria-label="Jenkins Pipeline">Jenkins Pipeline</a><ul><ul><li><a href=#%e4%b8%80%e6%a6%82%e5%bf%b5 aria-label=一、概念>一、概念</a></li><li><a href=#%e4%ba%8cjenkinsfile-%e4%bd%bf%e7%94%a8%e6%96%b9%e6%b3%95 aria-label="二、Jenkinsfile 使用方法">二、Jenkinsfile 使用方法</a><ul><ul><li><a href=#1pipeline-script aria-label="1、Pipeline script">1、Pipeline script</a></li><li><a href=#2pipeline-script-from-scm aria-label="2、Pipeline script from SCM">2、Pipeline script from SCM</a></li></ul></ul></li><li><a href=#%e4%b8%89jenkinsfile-%e8%af%ad%e6%b3%95 aria-label="三、Jenkinsfile 语法">三、Jenkinsfile 语法</a><ul><ul><li><a href=#declarative-pipeline aria-label="Declarative pipeline">Declarative pipeline</a></li><li><a href=#2scripts-pipeline aria-label="2、Scripts pipeline">2、Scripts pipeline</a></li></ul></ul></li></ul></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener('DOMContentLoaded',function(b){checkTocPosition(),elements=document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]'),activeElement=elements[0];const a=encodeURI(activeElement.getAttribute('id')).toLowerCase();document.querySelector(`.inner ul li a[href="#${a}"]`).classList.add('active')},!1),window.addEventListener('resize',function(a){checkTocPosition()},!1),window.addEventListener('scroll',()=>{activeElement=Array.from(elements).find(a=>{if(getOffsetTop(a)-window.pageYOffset>0&&getOffsetTop(a)-window.pageYOffset<window.innerHeight/2)return a})||activeElement,elements.forEach(a=>{const b=encodeURI(a.getAttribute('id')).toLowerCase();a===activeElement?document.querySelector(`.inner ul li a[href="#${b}"]`).classList.add('active'):document.querySelector(`.inner ul li a[href="#${b}"]`).classList.remove('active')})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue('--gap'),10);function checkTocPosition(){const a=document.body.scrollWidth;a-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(a){if(!a.getClientRects().length)return 0;let b=a.getBoundingClientRect(),c=a.ownerDocument.defaultView;return b.top+c.pageYOffset}</script><div class=post-content><h1 id=jenkins-pipeline>Jenkins Pipeline<a hidden class=anchor aria-hidden=true href=#jenkins-pipeline>#</a></h1><h3 id=一概念>一、概念<a hidden class=anchor aria-hidden=true href=#一概念>#</a></h3><p>将整个持续集成的过程用解释性代码 <code>jenkinsfile</code> 来描述。</p><h3 id=二jenkinsfile-使用方法>二、Jenkinsfile 使用方法<a hidden class=anchor aria-hidden=true href=#二jenkinsfile-使用方法>#</a></h3><ul><li>Pipeline script</li><li>Pipeline script from SCM</li></ul><h5 id=1pipeline-script>1、Pipeline script<a hidden class=anchor aria-hidden=true href=#1pipeline-script>#</a></h5><p>创建第一个 pipeline 项目</p><ul><li>新建项目</li><li>输入项目名称</li><li>选择流水线项目</li><li>点击确定</li><li>进入配置页面，配置 pipeline</li></ul><p>下拉到页面最底部，定义流水线脚本有两种方式，默认是在配置页面编辑脚本，也就是 <code>Pipeline script</code>，点击输入框右上角的</p><p><code>try simple Pipeline...</code></p><p>就可以自动生成一个 demo 脚本。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>pipeline</span> {
    <span style=color:#960050;background-color:#1e0010>//</span> <span style=color:#960050;background-color:#1e0010>构建节点，any</span> <span style=color:#960050;background-color:#1e0010>代表任意节点</span>
    <span style=color:#960050;background-color:#1e0010>agent</span> <span style=color:#960050;background-color:#1e0010>any</span>  
	  <span style=color:#960050;background-color:#1e0010>//</span> <span style=color:#960050;background-color:#1e0010>构建阶段，可以有多个阶段</span>
    <span style=color:#960050;background-color:#1e0010>stages</span> <span style=color:#960050;background-color:#1e0010>{</span>  
        <span style=color:#960050;background-color:#1e0010>//</span> <span style=color:#960050;background-color:#1e0010>构建阶段一</span>
        <span style=color:#960050;background-color:#1e0010>stage(</span><span style=color:#f92672>&#34;Hello&#34;</span><span style=color:#960050;background-color:#1e0010>)</span> {
            <span style=color:#960050;background-color:#1e0010>//</span> <span style=color:#960050;background-color:#1e0010>阶段一执行的步骤一</span>
            <span style=color:#960050;background-color:#1e0010>//</span> <span style=color:#960050;background-color:#1e0010>可以有多个步骤</span>
            <span style=color:#960050;background-color:#1e0010>steps</span> <span style=color:#960050;background-color:#1e0010>{</span>
                <span style=color:#960050;background-color:#1e0010>//</span> <span style=color:#960050;background-color:#1e0010>步骤内构建脚本</span>
                <span style=color:#960050;background-color:#1e0010>echo</span> <span style=color:#f92672>&#34;Hello World!&#34;</span>
            }
        }
    <span style=color:#960050;background-color:#1e0010>}</span>
    <span style=color:#960050;background-color:#1e0010>//</span> <span style=color:#960050;background-color:#1e0010>构建后置操作</span>
    <span style=color:#960050;background-color:#1e0010>post</span> {
        <span style=color:#960050;background-color:#1e0010>//</span> <span style=color:#960050;background-color:#1e0010>always</span> <span style=color:#960050;background-color:#1e0010>代表总是触发</span>
        <span style=color:#960050;background-color:#1e0010>always</span> <span style=color:#960050;background-color:#1e0010>{</span>  
            <span style=color:#960050;background-color:#1e0010>echo</span> <span style=color:#f92672>&#34;Say goodbye!&#34;</span>
        }
    <span style=color:#960050;background-color:#1e0010>}</span>
<span style=color:#960050;background-color:#1e0010>}</span>
</code></pre></div><p>保存配置后，进行构建，第一个流水线任务就建立完成了。</p><p><img loading=lazy src=https://gitee.com/abeelan/image-hosting-service/raw/master/img/image-20211203184523509.png alt=效果图></p><h5 id=2pipeline-script-from-scm>2、Pipeline script from SCM<a hidden class=anchor aria-hidden=true href=#2pipeline-script-from-scm>#</a></h5><p>远程仓库检出脚本构建</p><p>在配置页面上编写 jenkinsfile 有个缺点，如果内容有变更的话，需要登录 Jenkins 平台修改，比较麻烦。所以流水线项目提供从远程仓库检出 jenkiinsfile 的方式构建。</p><ul><li>新建一个 Jenkins file，填入上面的脚本内容，提交远程代码仓库。</li><li>回到配置页面，流水线定义选中 <code>Pipeline script form SCM</code>，配置远程代码仓库</li><li>选择 SVN（Git 类似）</li><li>填写仓库地址（Repository URL）</li><li>配置验证信息，有代码仓库访问权限的账号（Credentials）</li><li>填写 Jenkinsfile 脚本路径，就是远程仓库脚本的存放目录</li><li>eg： <code>./ci/jenkinsfile</code></li><li>保存后进行构建</li></ul><p><img loading=lazy src=https://gitee.com/abeelan/image-hosting-service/raw/master/img/image-20211203184322389.png alt="从 SVN 检出进行构建"></p><h3 id=三jenkinsfile-语法>三、Jenkinsfile 语法<a hidden class=anchor aria-hidden=true href=#三jenkinsfile-语法>#</a></h3><ul><li>Declarative pipeline（结构化方式）</li><li>Scripts pipeline（groovy 语法）</li></ul><h5 id=declarative-pipeline>Declarative pipeline<a hidden class=anchor aria-hidden=true href=#declarative-pipeline>#</a></h5><p>1、所有内容必须包含在一个 pipeline 代码块内：<code>pipeline {}</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>pipeline</span> {
	<span style=color:#960050;background-color:#1e0010>...</span>
}
</code></pre></div><p>2、agent（必填指令）：执行节点</p><ul><li>any：可以在任意节点上执行 pipeline 的构建</li><li>none：pipeline 不分配全局节点，每个 stage 自己分配</li><li>label：指定运行节点的 label</li><li>node：自定义运行节点配置<ul><li>指定 label</li><li>指定 自定义工作目录</li></ul></li><li>docker：控制目标节点上的 docker 运行相关内容</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>pipeline</span> {
  <span style=color:#960050;background-color:#1e0010>agent</span> <span style=color:#960050;background-color:#1e0010>{</span>
    <span style=color:#960050;background-color:#1e0010>node</span> <span style=color:#960050;background-color:#1e0010>{</span>
      <span style=color:#960050;background-color:#1e0010>label</span> <span style=color:#f92672>&#34;myslave&#34;</span>
      <span style=color:#960050;background-color:#1e0010>customWorkspace</span> <span style=color:#e6db74>&#34;myWorkSpace&#34;</span>
    }
  <span style=color:#960050;background-color:#1e0010>}</span>
<span style=color:#960050;background-color:#1e0010>}</span>
</code></pre></div><p>3、stages（必填指令）：包含一个或者多个 stage 的序列，pipeline 大部分工作在此执行。</p><ul><li>无参数</li><li>唯一</li></ul><p>4、stage（必填指令）：包含在 stages 中，pipeline 完成的所有工作都需要包含到 stage 中</p><ul><li>无参数</li><li>需要定义 stage 名字</li><li>可以写多个</li></ul><p>5、steps（必填指令）：包含在 stage 中，具体执行步骤</p><ul><li>无参数</li><li>可以写多个</li></ul><p>6、post（非必填指令）：定义 stages 运行结束后的操作</p><ul><li>always：无论 stages 运行结果如何，都会执行</li><li>changed：只有当运行结果与上次运行结果不同时，才会执行</li><li>failure：仅当运行结果为失败时，才会执行</li><li>sucess：仅当运行结果为成功时，才会执行</li><li>unstable：仅当运行结果不稳定时，才会执行</li><li>aborted：仅当运行中止状态时，才会执行</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>post</span> {
  <span style=color:#960050;background-color:#1e0010>always</span> <span style=color:#960050;background-color:#1e0010>{</span>
    <span style=color:#960050;background-color:#1e0010>echo</span> <span style=color:#f92672>&#34;always&#34;</span>
  }
  <span style=color:#960050;background-color:#1e0010>success</span> {
    <span style=color:#960050;background-color:#1e0010>echo</span> <span style=color:#f92672>&#34;success&#34;</span>
    <span style=color:#960050;background-color:#1e0010>sleep</span> <span style=color:#ae81ff>2</span>
  }
  <span style=color:#960050;background-color:#1e0010>unstable</span> {
    <span style=color:#960050;background-color:#1e0010>echo</span> <span style=color:#f92672>&#34;unstable&#34;</span>
  }
<span style=color:#960050;background-color:#1e0010>}</span>
</code></pre></div><p>7、environment（非必填指令）：定义运行时环境变量，无参数</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>environment</span> {
  <span style=color:#960050;background-color:#1e0010>test</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>&#39;hello</span> <span style=color:#960050;background-color:#1e0010>world&#39;</span>
}

<span style=color:#960050;background-color:#1e0010>stages</span> {
  <span style=color:#960050;background-color:#1e0010>stage(</span><span style=color:#f92672>&#34;print environment&#34;</span><span style=color:#960050;background-color:#1e0010>)</span> {
    <span style=color:#960050;background-color:#1e0010>steps</span> <span style=color:#960050;background-color:#1e0010>{</span>
      <span style=color:#960050;background-color:#1e0010>echo</span> <span style=color:#960050;background-color:#1e0010>test</span>
		}
	}
<span style=color:#960050;background-color:#1e0010>}</span>
</code></pre></div><p>8、options（非必填指令）：定义 pipeline 的专有属性，配置页内的其他自定义项</p><ul><li>buildDiscarder：保持构建的最大个数</li><li>disabelConcurrentBuilds：不允许并行执行 pipeline 任务</li><li>timeout：pipeline 超时时间</li><li>retry：重试次数</li><li>timestamps：预定义由 pipeline 生成的所有控制台输出时间</li><li>skipStagesAfterUnstable：一旦构建进入不稳定状态，就跳过此 stage</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>options</span> {
	<span style=color:#a6e22e>timeout</span>(<span style=color:#a6e22e>time</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span>, <span style=color:#a6e22e>unit</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;SECONDS&#34;</span>)
	<span style=color:#a6e22e>buildDiscarder</span>(<span style=color:#a6e22e>logRotator</span>(<span style=color:#a6e22e>numToKeepStr</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;2&#39;</span>))
	<span style=color:#a6e22e>retry</span>(<span style=color:#ae81ff>5</span>)
}
</code></pre></div><p>9、parameters（非必填指令）：定义 pipeline 的专有参数列表</p><ul><li>支持的数据类型<ul><li>booleanParam</li><li>choice</li><li>credentials：证书</li><li>file</li><li>text</li><li>password</li><li>run</li><li>string</li></ul></li><li>类似参数化构建的选项</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>parameters</span> {
	<span style=color:#a6e22e>string</span>(<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;PERSON&#34;</span>, <span style=color:#a6e22e>defaultValue</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;jenkins&#34;</span>, <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;输入的文本参数&#34;</span>)
}
<span style=color:#a6e22e>stages</span> {
	<span style=color:#a6e22e>stage</span>(<span style=color:#e6db74>&#34;Test Parameters&#34;</span>) {
		<span style=color:#a6e22e>steps</span> {
			<span style=color:#a6e22e>echo</span> <span style=color:#e6db74>&#34;Hello, ${params.PERSON}!&#34;</span>
		}
	}
}
</code></pre></div><p>10、triggers（非必填指令）：定义了 piplien 自动化触发的方式</p><ul><li>cron：接收一个 cron 风格的字符串来定义 pipeline 触发的常规间隔</li><li>pollSCM：接收一个 cron 风格的字符串来定义 Jenjkins 检查 SCM 源更改的常规间隔；如果存在更改，则 pipeline 被重新触发。</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>triggers</span> {
	<span style=color:#a6e22e>pollSCM</span>(<span style=color:#e6db74>&#39;H */4 * * 1-5&#39;</span>)
}
</code></pre></div><p>11、parallel（非必填指令）：并行构建</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>pipeline</span> {
  <span style=color:#a6e22e>agent</span> <span style=color:#a6e22e>none</span>
  <span style=color:#a6e22e>stages</span> {
    <span style=color:#a6e22e>stage</span>(<span style=color:#e6db74>&#34;并行构建&#34;</span>) {
      <span style=color:#a6e22e>parallel</span> {
        <span style=color:#a6e22e>stage</span>(<span style=color:#e6db74>&#34;stage - 001&#34;</span>) {
          <span style=color:#a6e22e>agent</span> {
            <span style=color:#a6e22e>label</span> <span style=color:#e6db74>&#34;slave1&#34;</span>
          }
          <span style=color:#a6e22e>steps</span> {
            <span style=color:#a6e22e>echo</span> <span style=color:#e6db74>&#34;在 slave1 节点上执行 stage - 001.&#34;</span>
            <span style=color:#a6e22e>sh</span> <span style=color:#e6db74>&#34;ifconfig&#34;</span>
            <span style=color:#a6e22e>sleep</span> <span style=color:#ae81ff>10</span>
          }
        }
        <span style=color:#a6e22e>stage</span>(<span style=color:#e6db74>&#34;stage -002&#34;</span>) {
          <span style=color:#a6e22e>agent</span> {
            <span style=color:#a6e22e>label</span> <span style=color:#e6db74>&#34;slave2&#34;</span>
          }
          <span style=color:#a6e22e>steps</span> {
            <span style=color:#a6e22e>echo</span> <span style=color:#e6db74>&#34;在 slave2 节点上执行 stage - 002.&#34;</span>
            <span style=color:#a6e22e>sh</span> <span style=color:#e6db74>&#34;ifconfig&#34;</span>
            <span style=color:#a6e22e>sleep</span> <span style=color:#ae81ff>10</span>
          }
        }
      }
    }
  }
}
</code></pre></div><h5 id=2scripts-pipeline>2、Scripts pipeline<a hidden class=anchor aria-hidden=true href=#2scripts-pipeline>#</a></h5><p>基于 groovy 语法定制的一种领域专用语言（DSL）</p><blockquote><p>DSL (Domain Specific Language)</p><p>A specialized computer language designed for a specific task.</p><p>为了解决某一类任务而专门设计的计算机语言。</p></blockquote><p>优点：</p><ul><li>灵活性高</li><li>可扩展性更好</li><li>与 Declarative pipeline 语法类型</li></ul><p>流程控制 - if/else</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>node</span> {
	<span style=color:#a6e22e>stage</span>(<span style=color:#e6db74>&#34;if/else demo&#34;</span>){
		<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>BRANCH_NAME</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;master&#34;</span>) {
			<span style=color:#a6e22e>echo</span> <span style=color:#e6db74>&#34;master branch&#34;</span>
		} <span style=color:#66d9ef>else</span> {
			<span style=color:#a6e22e>echo</span> <span style=color:#e6db74>&#34;else branch&#34;</span>
		}
	}
}
</code></pre></div><p>流程控制 - try/carch</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>node</span> {
	<span style=color:#a6e22e>echo</span> <span style=color:#e6db74>&#34;This is test stage which run on the slave agent.&#34;</span>
	<span style=color:#66d9ef>try</span> {
		<span style=color:#a6e22e>echo</span> <span style=color:#e6db74>&#34;try block.&#34;</span>
	} <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>exc</span>) {
		<span style=color:#a6e22e>echo</span> <span style=color:#e6db74>&#34;catch block.&#34;</span>
	} <span style=color:#66d9ef>finally</span> {
		<span style=color:#75715e>// 兜底执行
</span><span style=color:#75715e></span>		<span style=color:#a6e22e>echo</span> <span style=color:#e6db74>&#34;finally block.&#34;</span>
	}
}
</code></pre></div><p>控制全局工具设置的环境变量与运行命令</p><ul><li>定义 maven Name & MAVEN_HOME</li><li>定义 java Name & JAVA_HOME</li><li>定义 allure Name & ALLURE_HOME</li><li>&mldr;</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>stage</span>(<span style=color:#e6db74>&#34;maven deploy&#34;</span>) {
	<span style=color:#a6e22e>node</span>(<span style=color:#e6db74>&#34;master&#34;</span>) {
		<span style=color:#a6e22e>sh</span> <span style=color:#e6db74>&#34;. ~/.bash_profile&#34;</span>
		
		<span style=color:#75715e>// 定义 maven 工具，工具在全局工具设置添加好，这里去获取
</span><span style=color:#75715e></span>		<span style=color:#75715e>// 全局工具设置（Manager Jenkins - Global Tools Configuration）
</span><span style=color:#75715e></span>		<span style=color:#a6e22e>def</span> <span style=color:#a6e22e>mvnHome</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>tool</span> <span style=color:#e6db74>&#34;maven_3.6.0_master&#34;</span>
		<span style=color:#a6e22e>def</span> <span style=color:#a6e22e>jdkHome</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>tool</span> <span style=color:#e6db74>&#34;jdk_1.8_master&#34;</span>
		<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>PATH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;${mvnHome}/bin:${env.PATH}&#34;</span>
		<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>PATH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;${jdkHome}/bin:${env.PATH}&#34;</span>
		<span style=color:#a6e22e>sh</span> <span style=color:#e6db74>&#34;mvn clean install&#34;</span>
		<span style=color:#a6e22e>sh</span> <span style=color:#e6db74>&#34;mv target/iWeb.war target/ROOT.war&#34;</span>
	}
}
</code></pre></div><p>以上就是 jenkinsfile 的基本用法，先有一个大概的认识，了解了解语法，编写过程中随用随查。</p></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://abeelan.github.io/img/wechatpay.jpg alt=wechat_pay></a><p>微信</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://abeelan.github.io/img/alipay.jpg alt=alipay></a><p>支付宝</p></div></div><button id=rewardButton onclick="var qr=document.getElementById('QR');qr.style.opacity==='0'?qr.style.opacity='1':qr.style.opacity='0'">
<span>🧧 鼓励一下 🧧</span></button></div></div><footer class=post-footer><nav class=paginav><a class=prev href=https://abeelan.github.io/posts/tech/jenkins/jenkins-%E5%9F%BA%E7%A1%80/><span class=title>« 上一页</span><br><span></span></a><a class=next href=https://abeelan.github.io/posts/tech/jenkins/k8s-easou/><span class=title>下一页 »</span><br><span></span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share  on twitter" href="https://twitter.com/intent/tweet/?text=&url=https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fjenkins%2fjenkinsfile%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fjenkins%2fjenkinsfile%2f&title=&summary=&source=https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fjenkins%2fjenkinsfile%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fjenkins%2fjenkinsfile%2f&title="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fjenkins%2fjenkinsfile%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on whatsapp" href="https://api.whatsapp.com/send?text=%20-%20https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fjenkins%2fjenkinsfile%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on telegram" href="https://telegram.me/share/url?text=&url=https%3a%2f%2fabeelan.github.io%2fposts%2ftech%2fjenkins%2fjenkinsfile%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></div></article></main><footer class=footer><span>Copyright
&copy;
-2023
<a href=https://abeelan.github.io/ style=color:#939393>ABEE</a>
All Rights Reserved</span>
<a href=https://beian.miit.gov.cn/ target=_blank style=color:#939393></a>&nbsp;
<span><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=null" style=display:inline-block;text-decoration:none;height:20px;color:#939393><img src style="float:left;margin:0 5px 0 0"></a></span>
<span id=busuanzi_container><span class="fa fa-user"></span><span id=busuanzi_value_site_uv></span><span class="fa fa-eye"></span><span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg><span id=read_progress></span></span></a><script>document.addEventListener('scroll',function(e){const a=document.getElementById("read_progress"),b=document.documentElement.scrollHeight,c=document.documentElement.clientHeight,d=document.documentElement.scrollTop||document.body.scrollTop;a.innerText=((d/(b-c)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>let mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>200||document.documentElement.scrollTop>200?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{(function(){document.cookie="change-themes="+escape("false")})(),document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.body.addEventListener('copy',function(a){if(window.getSelection().toString()&&window.getSelection().toString().length>50){let b=a.clipboardData||window.clipboardData;if(b){a.preventDefault();let c=window.getSelection().toString()+'\r\n\n————————————————\r\n'+'版权声明：本文为「'+"ABEE"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。'+'\r\n原文链接：'+location.href,d=window.getSelection().toString()+'\r\n\n————————————————\r\n'+'版权声明：本文为「'+"ABEE"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。'+'\r\n原文链接：'+location.href;b.setData('text/html',c),b.setData('text/plain',d)}}})</script><script>document.querySelectorAll('pre > code').forEach(c=>{const d=c.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='📄 复制';function i(){a.innerText='👌🏻 已复制!',setTimeout(()=>{a.innerText='📄 复制'},2e3)}a.addEventListener('click',d=>{if('clipboard'in navigator){let a=c.textContent+'\r\n————————————————\r\n'+'版权声明：本文为「'+"ABEE"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。'+'\r\n原文链接：'+location.href;navigator.clipboard.writeText(a),i();return}const a=document.createRange();a.selectNodeContents(c);const b=window.getSelection();b.removeAllRanges(),b.addRange(a);try{document.execCommand('copy'),i()}catch(a){}b.removeRange(a)});let j=c.className.replaceAll("language-",""),b=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),e=document.createElement("div");e.innerText=j,b.setAttribute('class','mac-tool'),f.setAttribute('class','mac bb1'),g.setAttribute('class','mac bb2'),h.setAttribute('class','mac bb3'),e.setAttribute('class','language-type'),b.appendChild(f),b.appendChild(g),b.appendChild(h),b.appendChild(e),d.classList.contains("highlight")?(d.appendChild(a),d.appendChild(b)):d.parentNode.firstChild==d||(c.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?(c.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a),d.appendChild(b)):(c.parentNode.appendChild(a),d.appendChild(b)))})</script><script>$("code[class^=language] ").on("mouseover",function(){this.clientWidth<this.scrollWidth&&($(this).css("width","135%"),$(this).css("border-top-right-radius","var(--radius)"))}).on("mouseout",function(){$(this).css("width","100%"),$(this).css("border-top-right-radius","unset")})</script></body></html>